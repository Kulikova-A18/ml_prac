# Отчёт по практике: Анализ системных вызовов с eBPF

## ФИО:

Куликова Алёна Владимировна

## Группа:

КБ-9

## Дата:

04.07.2025

##  Работа

Данный проект написан на ЯП питон. 

Сам код располагается по следующему пути: https://github.com/Kulikova-A18/ml_prac/blob/main/anomaly_detection.py

Красткое описание программы:

| Этап выполнения                             | Описание                                                                                          | Статус этапа                | Функция                     |
|--------------------------------------------|---------------------------------------------------------------------------------------------------|-----------------------|-----------------------------|
| Загрузка данных                            | Загружаем данные из файла activity_logcsv                                                    | Успешно или с ошибкой | load_data()               |
| Препроцессинг данных                       | Удаляем столбец timestamp и кодируем категориальные переменные с помощью LabelEncoder       | Успешно или с ошибкой | preprocess_data()         |
| Выделение признаков и меток               | Разделяем данные на признаки X и метки y                                                     | Успешно или с ошибкой | split_features_labels()    |
| Разделение данных на обучающую и тестовую выборки | Разделяем данные на обучающую и тестовую выборки с соотношением 80/20                         | Успешно или с ошибкой | split_data()              |
| Обучение модели (1-4 попытка)             | Обучаем модель на 100 эпох с использованием binary_crossentropy и adam                      | Успешно или с ошибками | train_model()             |
| Визуализация результатов                   | Строим графики для потерь и точности, сохраняем их в файлы                                     | Успешно или с ошибками | visualize_results()       |
| Оценка производительности                  | Строим матрицу ошибок и классификационный отчет, сохраняем их в файлы                          | Успешно или с ошибками | evaluate_performance()    |
| Сохранение модели                          | Сохраняем обученную модель в файл                                                               | Успешно или с ошибками | save_model()              |

После обучения с 1 по 4 попытка осуществляется сохранение истории, после которого осуществляется новое обучение по прошлому этапу

Все сохраненные попытки располагаются в архиве по следующему пути: https://github.com/Kulikova-A18/ml_prac/blob/main/anomaly_detection_models.tar.gz

Визуализация результатов 1 этапа:

1.графики потерь

![image](https://github.com/user-attachments/assets/7ca9c5fc-f0e3-4599-b564-5ac7c8be5f58)

2.графики точности

![image](https://github.com/user-attachments/assets/176f4a3c-3ba5-4cf6-8295-6c4d7d22cdfc)

Визуализация результатов 2 этапа:

1.графики потерь

![image](https://github.com/user-attachments/assets/d36bff16-09ad-40a9-a915-418cdfaa98f9)

2.графики точности

![image](https://github.com/user-attachments/assets/b97b4282-87d7-467a-9614-8101d42d1538)

Визуализация результатов 3 этапа:

1.графики потерь

![image](https://github.com/user-attachments/assets/aef00dcf-4a8d-423c-a9a7-ba5ba884c075)

2.графики точности

![image](https://github.com/user-attachments/assets/d93c931a-4574-4d22-b5b4-49e9e8256761)

Визуализация результатов 4 этапа:

1.графики потерь

![image](https://github.com/user-attachments/assets/03d55e4d-bb2c-4ef3-a21c-37b7234b7f1c)

2.графики точности

![image](https://github.com/user-attachments/assets/50dec972-68f5-4306-9855-515adc2bfad6)

А также после каждой попытки осуществлялась запись таблицы результатов:

1. Этап 1 располагается по следующей ссылке: https://github.com/Kulikova-A18/ml_prac/blob/main/classification_report_run_1.csv
1. Этап 2 располагается по следующей ссылке: https://github.com/Kulikova-A18/ml_prac/blob/main/classification_report_run_2.csv
1. Этап 3 располагается по следующей ссылке: https://github.com/Kulikova-A18/ml_prac/blob/main/classification_report_run_3.csv
1. Этап 4 располагается по следующей ссылке: https://github.com/Kulikova-A18/ml_prac/blob/main/classification_report_run_4.csv

Для полного понимания, предоставлена общая таблица

| Этап выполнения | Метрика        | 0                   | 1      | accuracy           | macro avg           | weighted avg         |
|-----------------|----------------|---------------------|--------|--------------------|---------------------|----------------------|
| Этап 1          | precision      | 0.9865              | 0.0    | 0.9865             | 0.4932              | 0.9732               |
|                 | recall         | 1.0                 | 0.0    |                    | 0.5                 | 0.9865               |
|                 | f1-score       | 0.9932              | 0.0    |                    | 0.4966              | 0.9798               |
|                 | support        | 73                  | 1      |                    | 74                  | 74                   |
|-----------------|----------------|---------------------|--------|--------------------|---------------------|----------------------|
| Этап 2          | precision      | 0.9865              | 0.0    | 0.9865             | 0.4932              | 0.9732               |
|                 | recall         | 1.0                 | 0.0    |                    | 0.5                 | 0.9865               |
|                 | f1-score       | 0.9932              | 0.0    |                    | 0.4966              | 0.9798               |
|                 | support        | 73                  | 1      |                    | 74                  | 74                   |
|-----------------|----------------|---------------------|--------|--------------------|---------------------|----------------------|
| Этап 3          | precision      | 0.9865              | 0.0    | 0.9865             | 0.4932              | 0.9732               |
|                 | recall         | 1.0                 | 0.0    |                    | 0.5                 | 0.9865               |
|                 | f1-score       | 0.9932              | 0.0    |                    | 0.4966              | 0.9798               |
|                 | support        | 73                  | 1      |                    | 74                  | 74                   |
|-----------------|----------------|---------------------|--------|--------------------|---------------------|----------------------|
| Этап 4          | precision      | 0.9865              | 0.0    | 0.9865             | 0.4932              | 0.9732               |
|                 | recall         | 1.0                 | 0.0    |                    | 0.5                 | 0.9865               |
|                 | f1-score       | 0.9932              | 0.0    |                    | 0.4966              | 0.9798               |
|                 | support        | 73                  | 1      |                    | 74                  | 74                   |

Краткий анализ результатов:

| Параметр        | Класс 0                          | Класс 1                         |
|------------------|----------------------------------|---------------------------------|
| precision  | 98.65% (высокая надежность)   | 0% (отсутствие предсказаний)   |
| recall      | 100% (все экземпляры идентифицированы) | 0% (ни одного экземпляра выявлено) |
| F1-мера               | 99.32% (высокая производительность) | 0% (отсутствие предсказаний)   |
| support        | 98.65%                        |                                 |
| Macro Average         | Сильные результаты            | Слабые результаты               |
| Weighted Average      | Сильные результаты            | Слабые результаты               |

Обоснование классов:

- Класс 0 - нормальное событие в проведении машинного обучения
- Класс 1 - аномальное событие в проведении машинного обучения

Модель использует функцию активации sigmoid в последнем слое, который выдет бинарную квалификацию: 0 и 1

