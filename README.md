# 3. Построение и обучение простой модели для обнаружения аномалий

Вы завершили полевое расследование в [изолированной Linux-среде](https://github.com/frizzymonsta/docker_prac/), зафиксировали системную активность (системные вызовы, сетевые пакеты, логи) и собрали её в виде структурированного CSV-файла.

Теперь ваша задача — применить методы машинного обучения для автоматического обнаружения подозрительных действий на основе этих данных.

Ваша цель: построить и обучить модель, способную отличать нормальные события от аномальных, по данным, полученным в ходе расследования.

## Цели задания

* Выполнить предобработку CSV-датасета: очистка, фильтрация, кодирование.
* Провести разведочный анализ данных ([EDA](https://www.ibm.com/think/topics/exploratory-data-analysis)) с графиками и сводками.
* Построить модель бинарной классификации (норма / аномалия) и обучить её.
* Визуализировать результаты обучения (loss, accuracy).
* Построить матрицу ошибок, рассчитать метрики качества (precision, recall, F1).
* Сохранить обученную модель и загрузить обратно для проверки.

## Данные

Ваш `CSV`-датасет из предыдущего задания.

Пример:

```csv
timestamp,source,event_type,details,classification
2025-06-23 12:02:33,client,syscall,execve /usr/bin/curl http://10.10.0.2:8080/exploit,1
```

## Этапы работы

### 1. Загрузка и анализ данных

Используйте [pandas](https://pandas.pydata.org/docs/) для загрузки датасета.

Проверьте пропуски, типы данных, распределение классов.

Постройте:
* Диаграммы распределения классов
* Гистограммы по признакам.

### 2. Препроцессинг

Удалите ненужные признаки.

Преобразуйте категориальные признаки с помощью [LabelEncoder](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html).

Выделите X и y, где:
* X — признаки;
* y — колонка разметки.

### 3. Разделение на обучающие и тестовые данные

[train_test_split](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html)

### 4. Построение модели

Для построения модели можно использовать любые фреймворки. Примеры: sklearn, tensorflow/keras, pytorch.

По необходимости примените обработчики на данных и поменяйте размер тензора.

**Обоснуйте свой выбор по модели, ее параметрам и преобразованию данных.**

### 5. Обучение и визуализация

Визуализируйте loss и accuracy по итерациям обучения (matplotlib/seaborn).

### 6. Оценка производительности

* Постройте матрицу зависимостей.
* Постройте сводный отчет.

### 7. Сохранение и загрузка модели

* Сохраните модель.
* Загрузите её обратно и запринтуйте ее структуру.

##  Что нужно сдать

* notebook.ipynb или .py со всем кодом.
* Визуализации и итоговая матрица ошибок.
* Сохранённая модель.
* Небольшой README.md, где описано:
    * Какие признаки вы выбрали и почему.
    * Что показала модель.
    * Какие атаки удалось уловить.

## Совет

Не бойтесь переобучения/недообучения — в этом задании не важна точность модели, важно пройти весь цикл анализа от загрузки данных до экспортируемой модели. Это практическое упражнение на воспроизводимость и понимание этапов ML.

Отправлять на `zelichenok@comsec.spb.ru`.
